# Load basic modules
module(load="imuxsock")
module(load="imfile" PollingInterval="10")

# Create state directory if it doesn't exist
$WorkDirectory /var/spool/rsyslog

# Monitor PM2 out log
input(type="imfile"
      File="/var/log/pm2/out.log"
      Tag="pm2-out"
      Severity="info"
      Facility="local0"
      StateFile="stat-pm2-out")

# Monitor PM2 error log
input(type="imfile"
      File="/var/log/pm2/error.log"
      Tag="pm2-error"
      Severity="error"
      Facility="local0"
      StateFile="stat-pm2-error")

# Forward everything to Graylog via UDP
*.* @graylog:5140